<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HLB Write-Offs</title>
<style>
  body { 
    font-family: Arial, sans-serif; 
    margin: 0; 
    background: #f5f7fa; 
    padding: 20px; 
  }

  :root {
    --hlb-blue: #0F4C81;
    --hlb-light-blue: #4FC3F7;
    --hlb-accent: #A1D884;
  }
  
  /* ===== TOPBAR ===== */
  .topbar {
    display: flex;
    align-items: center;
    background: var(--hlb-blue);
    padding: 10px 20px;
    color: #fff;
    gap: 10px;
  }
  .topbar button {
    background: #fff;
    color: var(--hlb-blue);
    border: none;
    border-radius: 6px;
    padding: 8px 14px;
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
  }
  .active { background: var(--hlb-accent) !important; color: #fff !important; }

  /* ===== TABLE ===== */
  table { border-collapse: collapse; width: 100%; margin-top: 20px; background: #fff; }
  th, td { border: 1px solid #ccc; padding: 8px 12px; text-align: center; }
  th { background: var(--hlb-blue); color: #fff; }
  input[type="number"] { width: 100px; padding: 4px; text-align: right; }

  /* ===== SUMMARY ===== */
  .summary-box {
    margin-top: 15px;
    background: var(--hlb-light-blue);
    padding: 12px;
    border-radius: 8px;
    color: #00334d;
    font-size: 16px;
    font-weight: bold;
  }

  /* ===== BUTTON ===== */
  .submit-btn {
    margin-top: 20px;
    padding: 12px 22px;
    font-size: 16px;
    background: var(--hlb-blue);
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }
</style>
</head>
<body>

<div class="topbar">
  <button onclick="window.location.href='timesheet3.html'">üìù Timesheet</button>
  <button onclick="window.location.href='fees.html'">üí∞ Fees</button>
  <button class="active">‚úèÔ∏è Write-Offs</button>
</div>

<h2>Client Write-Offs</h2>

<div class="summary-box">
  üéØ Total Write-Off Entered: <span id="totalWO">$0</span>
</div>

<table id="writeoffTable">
  <tr>
    <th>WIP Code</th>
    <th>Fee Input ($)</th>
    <th>Write-Off Input ($)</th>
  </tr>

  <!-- Dummy APS-style rows -->
  <tr>
    <td>WIP-87321</td>
    <td><input type="number" value="12500" min="0" oninput="updateTotals()"></td>
    <td><input type="number" value="0" min="0" oninput="updateTotals()"></td>
  </tr>

  <tr>
    <td>WIP-99214</td>
    <td><input type="number" value="8200" min="0" oninput="updateTotals()"></td>
    <td><input type="number" value="0" min="0" oninput="updateTotals()"></td>
  </tr>

  <tr>
    <td>WIP-55109</td>
    <td><input type="number" value="15300" min="0" oninput="updateTotals()"></td>
    <td><input type="number" value="0" min="0" oninput="updateTotals()"></td>
  </tr>

  <tr>
    <td>WIP-44387</td>
    <td><input type="number" value="6700" min="0" oninput="updateTotals()"></td>
    <td><input type="number" value="0" min="0" oninput="updateTotals()"></td>
  </tr>

</table>

<button class="submit-btn" onclick="submitWriteOffs()">Submit Write-Offs</button>

<script>
function updateTotals() {
  const table = document.getElementById('writeoffTable');
  const rows = table.querySelectorAll('tr');
  let total = 0;

  // Loop each row, read write-off value
  for (let i = 1; i < rows.length; i++) {
    const writeOff = Number(rows[i].cells[2].querySelector('input').value || 0);
    total += writeOff;
  }

  document.getElementById('totalWO').textContent = 
    "$" + total.toLocaleString();
}

function submitWriteOffs() {
  const rows = document.querySelectorAll('#writeoffTable tr');
  const results = [];

  for (let i = 1; i < rows.length; i++) {
    const wip = rows[i].cells[0].textContent;
    const fee = Number(rows[i].cells[1].querySelector('input').value);
    const writeoff = Number(rows[i].cells[2].querySelector('input').value);

    if (writeoff > 0) {
      results.push({
        wipCode: wip,
        feeAmount: fee,
        writeOffAmount: writeoff,
        percent: (writeoff / fee)
      });
    }
  }

  if (results.length === 0) {
    alert("No write-offs entered.");
    return;
  }

  console.log("JSON payload for backend:", results);
  alert("Write-offs submitted! (Open console to view payload)");
}
</script>

</body>
</html>
